<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        let arr = [
        { id: 1, name: '部门1', pid: 0 },
        { id: 2, name: '部门2', pid: 1 },
        { id: 3, name: '部门3', pid: 1 },
        { id: 4, name: '部门4', pid: 3 },
        { id: 5, name: '部门5', pid: 4 },
        { id: 6, name: '部门6', pid: 0 },
    ]
    res=[
        {
            id:1,
            children:[
                {id:2},
                {
                    id:3,
                    children:[
                        {
                            id:4,
                            children:[
                                {
                                    id:5
                                }
                            ]
                        },
                    ]
                }
            ]
        },
        {
            id:6
        }
    ]
    function js2Tree(data){
        let res=[]
        if(!Array.isArray(data)){
            return res
        }
        const map=new Map()
        data.forEach(item=>{
            map.set(item.id,item)
        })
        data.forEach(item=>{
            const parent=map.get(item.pid)
            if(parent){
                if(!parent.children){
                    parent.children=[]
                }
                parent.children.push(item)
            }else{
                res.push(item)
            }
        })
        return res
    }
    console.log(js2Tree(arr))
    </script>
</body>
</html>
